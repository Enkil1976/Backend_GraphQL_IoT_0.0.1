
> backend-graphql-iot@1.0.0 start
> node src/server.js

Persisted queries are enabled and are using an unbounded cache. Your server is vulnerable to denial of service attacks via memory exhaustion. Set `cache: "bounded"` or `persistedQueries: false` in your ApolloServer constructor, or see https://go.apollo.dev/s/cache-backends for other alternatives.
🚀 GraphQL Server ready at http://localhost:4001/graphql
🔗 GraphQL Subscriptions ready at ws://localhost:4001undefined
🔧 Initializing services...
🔌 Connecting to MQTT broker... {
  url: 'mqtts://Backend:11211121@sdb201a6.ala.us-east-1.emqxsl.com:8883',
  clientId: 'mqtt_client_graphql_af686c0be027',
  username: 'Backend',
  passwordSet: true
}
✅ MQTT service initialized
🚧 Queue service temporarily disabled for Redis debugging
🚀 Starting rules engine...
✅ Redis connected successfully
✅ Redis ready
✅ MQTT connected successfully
📡 Successfully subscribed to topic: Invernadero/# with QoS 0
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.898Z
   📡 Topic: Invernadero/Agua/Temp
   📄 Payload: 20.6
🎯 TOPIC STRUCTURE VALID: Agua/Temp
💧 Processing water data for table: calidad_agua
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.898Z
   📡 Topic: Invernadero/Agua/data
   📄 Payload: {"ph": 5, "ec":1000, "ppm": 1000, "temp": 18 }
🎯 TOPIC STRUCTURE VALID: Agua/data
💧 Processing water data for table: calidad_agua
✅ Water data JSON parsed: { ph: 5, ec: 1000, ppm: 1000, temp: 18 }
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.899Z
   📡 Topic: Invernadero/Agua/temp
   📄 Payload: {"temp": 18 }
🎯 TOPIC STRUCTURE VALID: Agua/temp
💧 Processing water data for table: calidad_agua
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.899Z
   📡 Topic: Invernadero/Bomba/sw
   📄 Payload: {"bombaSw":true }
🎯 TOPIC STRUCTURE VALID: Bomba/sw
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.900Z
   📡 Topic: Invernadero/Calefactor/sw
   📄 Payload: {"calefactorSw":true }
🎯 TOPIC STRUCTURE VALID: Calefactor/sw
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.900Z
   📡 Topic: Invernadero/CalefactorAgua/sw
   📄 Payload: {"calefactorAguaSw":true }
🎯 TOPIC STRUCTURE VALID: CalefactorAgua/sw
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:22.900Z
   📡 Topic: Invernadero/Ventilador/sw
   📄 Payload: {"ventiladorSw":true }
🎯 TOPIC STRUCTURE VALID: Ventilador/sw
✅ Water quality data cached
🐌 Slow query detected (1098ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
✅ Rules engine started successfully
✅ Rules engine initialized
🎉 Service initialization completed
✅ Database insert successful - Table: calidad_agua
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:37.525Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.7,"humedad":73.3,"heatindex":11.9,"dewpoint":8.1,"rssi":-75,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.8,"hmin":38.2,"hmax":73.8,"havg":73.1,"total":3549,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.7,
  humedad: 73.3,
  heatindex: 11.9,
  dewpoint: 8.1,
  rssi: -75,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.8,
    hmin: 38.2,
    hmax: 73.8,
    havg: 73.1,
    total: 3549,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
🔍 GraphQL Operation: undefined
[DeviceMutation] Turning ON device 2 { user: 'admin' }
Device status updated: Ventilador de Circulación (ID: 2) to on
📡 Sending MQTT command to Invernadero/Ventilador/sw: { ventiladorSw: true }
✅ MQTT command sent successfully for device Ventilador de Circulación
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:38.799Z
   📡 Topic: Invernadero/Ventilador/sw
   📄 Payload: {"ventiladorSw":true}
🎯 TOPIC STRUCTURE VALID: Ventilador/sw
[DeviceMutation] Turned ON device 2: Ventilador de Circulación
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "73.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "73.3"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:44.755Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.7,"humedad":76.2,"heatindex":10.9,"dewpoint":7.7,"rssi":-76,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.8,"hmin":38.9,"hmax":76.2,"havg":76.1,"total":3543,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.7,
  humedad: 76.2,
  heatindex: 10.9,
  dewpoint: 7.7,
  rssi: -76,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.8,
    hmin: 38.9,
    hmax: 76.2,
    havg: 76.1,
    total: 3543,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "76.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "76.2"
🐌 Slow query detected (1088ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🔍 GraphQL Operation: undefined
[DeviceMutation] Turning OFF device 2 { user: 'admin' }
Device status updated: Ventilador de Circulación (ID: 2) to off
📡 Sending MQTT command to Invernadero/Ventilador/sw: { ventiladorSw: false }
✅ MQTT command sent successfully for device Ventilador de Circulación
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:13:56.746Z
   📡 Topic: Invernadero/Ventilador/sw
   📄 Payload: {"ventiladorSw":false}
🎯 TOPIC STRUCTURE VALID: Ventilador/sw
[DeviceMutation] Turned OFF device 2: Ventilador de Circulación
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:14:07.905Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.6,"humedad":74.3,"heatindex":11.9,"dewpoint":8.2,"rssi":-78,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.7,"hmin":38.2,"hmax":74.3,"havg":73.4,"total":3550,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.6,
  humedad: 74.3,
  heatindex: 11.9,
  dewpoint: 8.2,
  rssi: -78,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.7,
    hmin: 38.2,
    hmax: 74.3,
    havg: 73.4,
    total: 3550,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "74.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "74.3"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:14:15.297Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.6,"humedad":76.3,"heatindex":10.8,"dewpoint":7.6,"rssi":-76,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.8,"hmin":38.9,"hmax":76.3,"havg":76.2,"total":3544,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.6,
  humedad: 76.3,
  heatindex: 10.8,
  dewpoint: 7.6,
  rssi: -76,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.8,
    hmin: 38.9,
    hmax: 76.3,
    havg: 76.2,
    total: 3544,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "76.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "76.3"
🐌 Slow query detected (1573ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:14:38.326Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.5,"humedad":74.8,"heatindex":11.8,"dewpoint":8.2,"rssi":-78,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.7,"hmin":38.2,"hmax":74.8,"havg":73.8,"total":3551,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.5,
  humedad: 74.8,
  heatindex: 11.8,
  dewpoint: 8.2,
  rssi: -78,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.7,
    hmin: 38.2,
    hmax: 74.8,
    havg: 73.8,
    total: 3551,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "74.8"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "74.8"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:14:45.615Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.6,"humedad":76.5,"heatindex":10.8,"dewpoint":7.6,"rssi":-75,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.7,"hmin":38.9,"hmax":76.5,"havg":76.3,"total":3545,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.6,
  humedad: 76.5,
  heatindex: 10.8,
  dewpoint: 7.6,
  rssi: -75,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.7,
    hmin: 38.9,
    hmax: 76.5,
    havg: 76.3,
    total: 3545,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "76.5"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "76.5"
🐌 Slow query detected (1158ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:15:08.714Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.5,"humedad":75.0,"heatindex":11.8,"dewpoint":8.2,"rssi":-75,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.6,"hmin":38.2,"hmax":75.0,"havg":74.2,"total":3552,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.5,
  humedad: 75,
  heatindex: 11.8,
  dewpoint: 8.2,
  rssi: -75,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.6,
    hmin: 38.2,
    hmax: 75,
    havg: 74.2,
    total: 3552,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "38.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "38.2"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:15:16.047Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.5,"humedad":76.6,"heatindex":10.7,"dewpoint":7.5,"rssi":-75,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.6,"hmin":38.9,"hmax":76.6,"havg":76.4,"total":3546,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.5,
  humedad: 76.6,
  heatindex: 10.7,
  dewpoint: 7.5,
  rssi: -75,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.6,
    hmin: 38.9,
    hmax: 76.6,
    havg: 76.4,
    total: 3546,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "76.6"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "76.6"
🐌 Slow query detected (1033ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:15:39.152Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.5,"humedad":75.1,"heatindex":11.8,"dewpoint":8.2,"rssi":-76,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.6,"hmin":38.2,"hmax":75.1,"havg":74.5,"total":3553,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.5,
  humedad: 75.1,
  heatindex: 11.8,
  dewpoint: 8.2,
  rssi: -76,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.6,
    hmin: 38.2,
    hmax: 75.1,
    havg: 74.5,
    total: 3553,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "75.1"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "75.1"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:15:46.473Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":76.9,"heatindex":10.6,"dewpoint":7.5,"rssi":-76,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.6,"hmin":38.9,"hmax":76.9,"havg":76.5,"total":3547,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 76.9,
  heatindex: 10.6,
  dewpoint: 7.5,
  rssi: -76,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.6,
    hmin: 38.9,
    hmax: 76.9,
    havg: 76.5,
    total: 3547,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "76.9"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "76.9"
🐌 Slow query detected (1285ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:16:09.569Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.4,"humedad":75.3,"heatindex":11.7,"dewpoint":8.2,"rssi":-79,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.5,"hmin":38.2,"hmax":75.3,"havg":74.7,"total":3554,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.4,
  humedad: 75.3,
  heatindex: 11.7,
  dewpoint: 8.2,
  rssi: -79,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.5,
    hmin: 38.2,
    hmax: 75.3,
    havg: 74.7,
    total: 3554,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "75.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "75.3"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:16:16.950Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.0,"heatindex":10.6,"dewpoint":7.5,"rssi":-74,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.5,"hmin":38.9,"hmax":77.0,"havg":76.7,"total":3548,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77,
  heatindex: 10.6,
  dewpoint: 7.5,
  rssi: -74,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.5,
    hmin: 38.9,
    hmax: 77,
    havg: 76.7,
    total: 3548,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "38.9"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "38.9"
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:16:39.966Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.4,"humedad":75.6,"heatindex":11.7,"dewpoint":8.2,"rssi":-75,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.5,"hmin":38.2,"hmax":75.6,"havg":75.0,"total":3555,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.4,
  humedad: 75.6,
  heatindex: 11.7,
  dewpoint: 8.2,
  rssi: -75,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.5,
    hmin: 38.2,
    hmax: 75.6,
    havg: 75,
    total: 3555,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "75.6"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "75.6"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:16:47.369Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.2,"heatindex":10.6,"dewpoint":7.6,"rssi":-76,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.5,"hmin":38.9,"hmax":77.2,"havg":76.8,"total":3549,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.2,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -76,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.5,
    hmin: 38.9,
    hmax: 77.2,
    havg: 76.8,
    total: 3549,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "77.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.2"
🐌 Slow query detected (1250ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:17:10.507Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.4,"humedad":75.6,"heatindex":11.7,"dewpoint":8.2,"rssi":-77,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.5,"hmin":38.2,"hmax":75.6,"havg":75.2,"total":3556,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.4,
  humedad: 75.6,
  heatindex: 11.7,
  dewpoint: 8.2,
  rssi: -77,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.5,
    hmin: 38.2,
    hmax: 75.6,
    havg: 75.2,
    total: 3556,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "75.6"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "75.6"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:17:17.818Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.3,"heatindex":10.6,"dewpoint":7.6,"rssi":-74,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.5,"hmin":38.9,"hmax":77.3,"havg":77.0,"total":3550,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.3,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -74,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.5,
    hmin: 38.9,
    hmax: 77.3,
    havg: 77,
    total: 3550,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "77.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.3"
🐌 Slow query detected (1050ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:17:40.818Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":75.6,"heatindex":11.6,"dewpoint":8.1,"rssi":-75,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.4,"hmin":38.2,"hmax":75.6,"havg":75.3,"total":3557,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 75.6,
  heatindex: 11.6,
  dewpoint: 8.1,
  rssi: -75,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.4,
    hmin: 38.2,
    hmax: 75.6,
    havg: 75.3,
    total: 3557,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "75.6"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "75.6"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:17:48.190Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.3,"heatindex":10.6,"dewpoint":7.6,"rssi":-74,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.3,"havg":77.1,"total":3551,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.3,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -74,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.3,
    havg: 77.1,
    total: 3551,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "77.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.3"
🐌 Slow query detected (1098ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:18:11.172Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":75.8,"heatindex":11.6,"dewpoint":8.2,"rssi":-74,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.4,"hmin":38.2,"hmax":75.8,"havg":75.4,"total":3558,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 75.8,
  heatindex: 11.6,
  dewpoint: 8.2,
  rssi: -74,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.4,
    hmin: 38.2,
    hmax: 75.8,
    havg: 75.4,
    total: 3558,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "75.8"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "75.8"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:18:18.591Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.4,"heatindex":10.6,"dewpoint":7.6,"rssi":-75,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.4,"havg":77.2,"total":3552,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.4,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -75,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.4,
    havg: 77.2,
    total: 3552,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "77.4"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.4"
🐌 Slow query detected (1010ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:18:41.599Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":76.0,"heatindex":11.6,"dewpoint":8.2,"rssi":-79,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.4,"hmin":38.2,"hmax":76.0,"havg":75.6,"total":3559,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 76,
  heatindex: 11.6,
  dewpoint: 8.2,
  rssi: -79,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.4,
    hmin: 38.2,
    hmax: 76,
    havg: 75.6,
    total: 3559,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "38.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "38.2"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:18:49.013Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.4,"heatindex":10.6,"dewpoint":7.6,"rssi":-76,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.4,"havg":77.2,"total":3553,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.4,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -76,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.4,
    havg: 77.2,
    total: 3553,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "77.4"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.4"
🐌 Slow query detected (1030ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:19:12.052Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":76.0,"heatindex":11.6,"dewpoint":8.2,"rssi":-76,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.3,"hmin":38.2,"hmax":76.0,"havg":75.7,"total":3560,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 76,
  heatindex: 11.6,
  dewpoint: 8.2,
  rssi: -76,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.3,
    hmin: 38.2,
    hmax: 76,
    havg: 75.7,
    total: 3560,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "38.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "38.2"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:19:19.433Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.4,"heatindex":10.6,"dewpoint":7.6,"rssi":-76,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.4,"havg":77.3,"total":3554,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.4,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -76,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.4,
    havg: 77.3,
    total: 3554,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
Database query error: error: invalid input syntax for type integer: "77.4"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.4"
🔍 Evaluating 0 active rules...
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:19:42.513Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":76.0,"heatindex":11.6,"dewpoint":8.2,"rssi":-76,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.3,"hmin":38.2,"hmax":76.0,"havg":75.8,"total":3561,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 76,
  heatindex: 11.6,
  dewpoint: 8.2,
  rssi: -76,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.3,
    hmin: 38.2,
    hmax: 76,
    havg: 75.8,
    total: 3561,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "38.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "38.2"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:19:49.882Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.4,"heatindex":10.6,"dewpoint":7.6,"rssi":-74,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.4,"havg":77.3,"total":3555,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.4,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -74,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.4,
    havg: 77.3,
    total: 3555,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
🐌 Slow query detected (1016ms): SELECT * FROM rules WHERE enabled = true ORDER BY priority ASC
🔍 Evaluating 0 active rules...
Database query error: error: invalid input syntax for type integer: "77.4"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.4"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:20:12.828Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":76.0,"heatindex":11.6,"dewpoint":8.2,"rssi":-78,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.3,"hmin":38.2,"hmax":76.0,"havg":75.9,"total":3562,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 76,
  heatindex: 11.6,
  dewpoint: 8.2,
  rssi: -78,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.3,
    hmin: 38.2,
    hmax: 76,
    havg: 75.9,
    total: 3562,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "38.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "38.2"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:20:20.094Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.4,"humedad":77.3,"heatindex":10.6,"dewpoint":7.6,"rssi":-75,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.4,"havg":77.3,"total":3556,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.4,
  humedad: 77.3,
  heatindex: 10.6,
  dewpoint: 7.6,
  rssi: -75,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.4,
    havg: 77.3,
    total: 3556,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
Database query error: error: column "stats_tmin" of relation "temhum2" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum2: column "stats_tmin" of relation "temhum2" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum2
🔍 Evaluating 0 active rules...
Database query error: error: invalid input syntax for type integer: "77.3"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 147,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $2 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum2: invalid input syntax for type integer: "77.3"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:20:43.294Z
   📡 Topic: Invernadero/TemHum1/data
   📄 Payload: {"temperatura":12.3,"humedad":76.0,"heatindex":11.6,"dewpoint":8.2,"rssi":-80,"boot":41,"mem":19304,"stats":{"tmin":6.4,"tmax":29.7,"tavg":12.3,"hmin":38.2,"hmax":76.0,"havg":75.9,"total":3563,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum1/data
🌡️ Processing TemHum data for table: temhum1
✅ JSON parsing successful: {
  temperatura: 12.3,
  humedad: 76,
  heatindex: 11.6,
  dewpoint: 8.2,
  rssi: -80,
  boot: 41,
  mem: 19304,
  stats: {
    tmin: 6.4,
    tmax: 29.7,
    tavg: 12.3,
    hmin: 38.2,
    hmax: 76,
    havg: 75.9,
    total: 3563,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum1
Database query error: error: column "stats_tmin" of relation "temhum1" does not exist
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:499:9) {
  length: 131,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '115',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
❌ Database insert failed - Table: temhum1: column "stats_tmin" of relation "temhum1" does not exist
🔄 Trying fallback query without stats_ prefix for table: temhum1
Database query error: error: invalid input syntax for type integer: "38.2"
    at /Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async query (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/config/database.js:79:20)
    at async MqttService.handleIncomingMessage (/Users/marcelosalcedo/Proyectos IoT/SistemaIoT/Backend_GraphQL_IoT/src/services/mqttService.js:508:13) {
  length: 148,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $11 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
❌ Fallback insert also failed - Table: temhum1: invalid input syntax for type integer: "38.2"
🚀 MQTT MESSAGE PROCESSING STARTED
   🕰️ Timestamp: 2025-07-06T03:20:50.560Z
   📡 Topic: Invernadero/TemHum2/data
   📄 Payload: {"temperatura":11.3,"humedad":77.3,"heatindex":10.5,"dewpoint":7.5,"rssi":-78,"boot":33,"mem":19240,"stats":{"tmin":5.5,"tmax":29.4,"tavg":11.4,"hmin":38.9,"hmax":77.4,"havg":77.3,"total":3557,"errors...
🎯 TOPIC STRUCTURE VALID: TemHum2/data
🌡️ Processing TemHum data for table: temhum2
✅ JSON parsing successful: {
  temperatura: 11.3,
  humedad: 77.3,
  heatindex: 10.5,
  dewpoint: 7.5,
  rssi: -78,
  boot: 33,
  mem: 19240,
  stats: {
    tmin: 5.5,
    tmax: 29.4,
    tavg: 11.4,
    hmin: 38.9,
    hmax: 77.4,
    havg: 77.3,
    total: 3557,
    errors: 0
  }
}
✅ Redis cache updated for sensor_latest:temhum2
